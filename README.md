# Sprinters

Competance project

## ML

### Prerequisits

Install all the requirements

```bash
pip3 install -r requirements.txt
```

### Generating models

> Models are generated by running [`ML/src/main.py`](ML/src/main.py) script.
>
> `RAW_DATA_PATH` indicates dataset which is used for training.
>
> Currently script is set up to use concrete model to speed up training.
> To find better model for new data use `models.search_model` instead (uncoment following code).
>
> ```python
> from sklearn.ensemble import RandomForestRegressor
> from models import search_model
> ...
> model = RandomForestRegressor(max_features="log2", n_estimators=180, > n_jobs=-1)
> model.fit(X, y)
> # model = search_model(X, y)
> ```
>

Command:

```bash
python ML/data/src/main.py
```

generates a model.

### Using models

`model.predict` expects `pandas.Dataframe` with specific column names for an input. `Dataframe` can be created from dictionary like this:

```python
import joblib
import pandas as pd

request = {
 'offer_type': 'Private',
 'floor': 4.0,
 'area': 67.0,
 'rooms': 4,
 'offer_type_of_building': 'Housing Block',
 'market': 'aftermarket',
 'longitude': 21.549882888793945,
 'latitude': 51.58496856689453,
 'city_name': 'Kozienice',
 'population': 18277.0,
 'voivodeship': 'Masovia'
}

loaded_model = joblib.load("../models/2022-11-13 19:09:05.094617.pkl")
single_X = pd.DataFrame({k: [v] for k, v in request.items()})

result = loaded_model.predict(single_X)[0]
```
